{
  "consumer": {
    "name": "olivia-gold-frontend"
  },
  "interactions": [
    {
      "description": "a login request with invalid credentials",
      "providerStates": [
        {
          "name": "user does not exist or credentials are invalid"
        }
      ],
      "request": {
        "body": {
          "email": "wrong@email.com",
          "password": "wrongpassword"
        },
        "headers": {
          "Content-Type": "application/json"
        },
        "method": "POST",
        "path": "/api/auth/login"
      },
      "response": {
        "body": {
          "code": "INVALID_CREDENTIALS",
          "error": "Unauthorized",
          "message": "Invalid email or password"
        },
        "headers": {
          "Content-Type": "application/json"
        },
        "matchingRules": {
          "body": {
            "$.code": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.error": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.message": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            }
          },
          "header": {},
          "status": {}
        },
        "status": 401
      }
    },
    {
      "description": "a login request with invalid email format",
      "providerStates": [
        {
          "name": "invalid email format provided"
        }
      ],
      "request": {
        "body": {
          "email": "invalid-email-format",
          "password": "ValidPassword123!"
        },
        "headers": {
          "Content-Type": "application/json"
        },
        "method": "POST",
        "path": "/api/auth/login"
      },
      "response": {
        "body": {
          "details": {
            "email": "Please provide a valid email address"
          },
          "error": "Validation Error",
          "message": "Invalid email format"
        },
        "headers": {
          "Content-Type": "application/json"
        },
        "matchingRules": {
          "body": {
            "$.details.email": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.error": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.message": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            }
          },
          "header": {},
          "status": {}
        },
        "status": 400
      }
    },
    {
      "description": "a registration request with existing email",
      "providerStates": [
        {
          "name": "email is already registered"
        }
      ],
      "request": {
        "body": {
          "email": "existing@oliviagold.com",
          "name": "Another User",
          "password": "AnotherPassword123!",
          "role": "CUSTOMER"
        },
        "headers": {
          "Content-Type": "application/json"
        },
        "method": "POST",
        "path": "/api/auth/register"
      },
      "response": {
        "body": {
          "code": "EMAIL_ALREADY_EXISTS",
          "error": "Conflict",
          "message": "Email already registered"
        },
        "headers": {
          "Content-Type": "application/json"
        },
        "matchingRules": {
          "body": {
            "$.code": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.error": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.message": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            }
          },
          "header": {},
          "status": {}
        },
        "status": 409
      }
    },
    {
      "description": "a registration request with valid data",
      "providerStates": [
        {
          "name": "email is not already registered"
        }
      ],
      "request": {
        "body": {
          "email": "newcustomer@example.com",
          "name": "New Customer",
          "password": "SecurePassword123!",
          "role": "CUSTOMER"
        },
        "headers": {
          "Content-Type": "application/json"
        },
        "method": "POST",
        "path": "/api/auth/register"
      },
      "response": {
        "body": {
          "message": "Registration successful",
          "token": "jwt-token-for-new-user",
          "user": {
            "createdAt": null,
            "email": "newcustomer@example.com",
            "id": "user-456",
            "name": "New Customer",
            "profile": {
              "avatar": null,
              "firstName": "New",
              "lastName": "Customer",
              "phone": null
            },
            "role": "CUSTOMER"
          }
        },
        "headers": {
          "Content-Type": "application/json"
        },
        "matchingRules": {
          "body": {
            "$.message": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.token": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.user.createdAt": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "regex",
                  "regex": "{\"generate\":\"2024-01-01T10:00:00Z\",\"matcher\":\"^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}\"}"
                }
              ]
            },
            "$.user.email": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.user.id": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.user.name": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.user.profile.avatar": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.user.profile.firstName": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.user.profile.lastName": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.user.profile.phone": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.user.role": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            }
          },
          "header": {},
          "status": {}
        },
        "status": 201
      }
    },
    {
      "description": "a registration request with weak password",
      "providerStates": [
        {
          "name": "weak password provided"
        }
      ],
      "request": {
        "body": {
          "email": "test@example.com",
          "name": "Test User",
          "password": "123",
          "role": "CUSTOMER"
        },
        "headers": {
          "Content-Type": "application/json"
        },
        "method": "POST",
        "path": "/api/auth/register"
      },
      "response": {
        "body": {
          "details": {
            "password": [
              "Password must be at least 8 characters long",
              "Password must contain at least one uppercase letter",
              "Password must contain at least one special character"
            ]
          },
          "error": "Validation Error",
          "message": "Password does not meet requirements"
        },
        "headers": {
          "Content-Type": "application/json"
        },
        "matchingRules": {
          "body": {
            "$.details.password[0]": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.details.password[1]": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.details.password[2]": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.error": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.message": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            }
          },
          "header": {},
          "status": {}
        },
        "status": 400
      }
    },
    {
      "description": "a request for current user info without token",
      "providerStates": [
        {
          "name": "user is not authenticated"
        }
      ],
      "request": {
        "method": "GET",
        "path": "/api/auth/me"
      },
      "response": {
        "body": {
          "error": "Unauthorized",
          "message": "Authentication token required"
        },
        "headers": {
          "Content-Type": "application/json"
        },
        "matchingRules": {
          "body": {
            "$.error": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.message": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            }
          },
          "header": {},
          "status": {}
        },
        "status": 401
      }
    },
    {
      "description": "a token refresh request",
      "providerStates": [
        {
          "name": "valid refresh token exists"
        }
      ],
      "request": {
        "body": {
          "refreshToken": "valid-refresh-token-123"
        },
        "headers": {
          "Content-Type": "application/json"
        },
        "method": "POST",
        "path": "/api/auth/refresh"
      },
      "response": {
        "body": {
          "expiresIn": "24h",
          "refreshToken": "new-refresh-token",
          "token": "new-jwt-token"
        },
        "headers": {
          "Content-Type": "application/json"
        },
        "matchingRules": {
          "body": {
            "$.expiresIn": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.refreshToken": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.token": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            }
          },
          "header": {},
          "status": {}
        },
        "status": 200
      }
    },
    {
      "description": "a token refresh request with invalid token",
      "providerStates": [
        {
          "name": "refresh token is invalid or expired"
        }
      ],
      "request": {
        "body": {
          "refreshToken": "invalid-or-expired-token"
        },
        "headers": {
          "Content-Type": "application/json"
        },
        "method": "POST",
        "path": "/api/auth/refresh"
      },
      "response": {
        "body": {
          "code": "INVALID_REFRESH_TOKEN",
          "error": "Unauthorized",
          "message": "Invalid or expired refresh token"
        },
        "headers": {
          "Content-Type": "application/json"
        },
        "matchingRules": {
          "body": {
            "$.code": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.error": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            },
            "$.message": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "type"
                }
              ]
            }
          },
          "header": {},
          "status": {}
        },
        "status": 401
      }
    }
  ],
  "metadata": {
    "pact-js": {
      "version": "15.0.1"
    },
    "pactRust": {
      "ffi": "0.4.22",
      "models": "1.2.3"
    },
    "pactSpecification": {
      "version": "3.0.0"
    }
  },
  "provider": {
    "name": "olivia-gold-auth-api"
  }
}